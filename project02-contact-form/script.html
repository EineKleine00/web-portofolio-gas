<script>
  document.getElementById('contactForm').addEventListener('submit', function(e) {
    e.preventDefault(); // Cegah reload
    
    var btn = document.getElementById('btnSubmit');
    var status = document.getElementById('status');
    var form = this;
    
    // Ubah tombol jadi loading
    btn.textContent = "Mengirim...";
    btn.disabled = true;
    status.textContent = "";

    // Ambil data form
    var data = {
      name: form.name.value,
      email: form.email.value,
      message: form.message.value
    };

    // Panggil Backend
    google.script.run
      .withSuccessHandler(function(response) {
        // Jika Backend Berhasil
        btn.textContent = "Kirim Pesan";
        btn.disabled = false;
        
        if (response === "Sukses") {
           status.style.color = "#4ade80"; // Hijau
           status.textContent = "✅ Data berhasil masuk ke Sheet!";
           form.reset();
        } else {
           // Jika backend melempar pesan error (misal Sheet ID salah)
           status.style.color = "#f87171"; // Merah
           status.textContent = response; 
        }
      })
      .withFailureHandler(function(error) {
        // Jika Gagal Koneksi Script
        btn.textContent = "Kirim Pesan";
        btn.disabled = false;
        status.style.color = "#f87171";
        status.textContent = "❌ Gagal koneksi: " + error.message;
      })
      .processForm(data); // <--- INI KUNCINYA (Harus sama dgn Code.gs)
  });
</script>
